{% extends "base_content.html" %}
{% load static %}

{% block head %}
<style>
    .calendar-grid {
        display: flex;
        flex-direction: column; /* Allow each week to stack */
        gap: 10px; /* Space between rows */
    }

    .week-row {
        display: grid;
        grid-template-columns: repeat(7, 1fr); /* 7 days per row */
        gap: 10px; /* Space between cells */
    }

    .day-cell {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: center;
        background-color: #f9f9f9;
        min-height: 120px; /* Adjust height for uniformity */
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        border-radius: 8px; /* Rounded corners */
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .day-cell.bg-light {
        background-color: #eaeaea; /* Highlight empty or out-of-month days */
    }

    .day-cell .date {
        font-weight: bold;
        margin-bottom: 5px;
        color: #333;
    }

    .day-cell ul {
        padding: 0;
        margin: 0;
        list-style: none;
    }

    .day-header {
        text-align: center;
        font-weight: bold;
        background-color: #007bff;
        color: white;
        padding: 10px;
        border-radius: 8px;
        text-transform: uppercase;
    }

    .calendar-navigation {
        margin-bottom: 20px;
    }

    .calendar-navigation .btn {
        padding: 10px 20px;
        font-size: 16px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="mb-4">Welcome, {{ request.user.first_name }}!</h1>
    <h2 class="mb-4 text-center">Your Timetable for {{ month_name }} {{ year }}</h2>

    <!-- Navigation Buttons -->
    <div class="d-flex justify-content-between calendar-navigation">
        {% if prev_year and prev_month %}
        <a href="{% url 'student_timetable_with_date' prev_year prev_month %}" class="btn btn-primary">← Previous</a>
        {% else %}
        <a href="#" class="btn btn-secondary disabled">← Previous</a>
        {% endif %}

        {% if next_year and next_month %}
        <a href="{% url 'student_timetable_with_date' next_year next_month %}" class="btn btn-primary">Next →</a>
        {% else %}
        <a href="#" class="btn btn-secondary disabled">Next →</a>
        {% endif %}
    </div>

    <!-- Calendar Grid -->
    <div class="calendar-grid">
        <!-- Render Day Headers -->
        <div class="week-row">
            <div class="day-header">Sunday</div>
            <div class="day-header">Monday</div>
            <div class="day-header">Tuesday</div>
            <div class="day-header">Wednesday</div>
            <div class="day-header">Thursday</div>
            <div class="day-header">Friday</div>
            <div class="day-header">Saturday</div>
        </div>

        <!-- Render Empty Days Before the First Day of the Month -->
        {% if empty_days_range %}
        <div class="week-row">
            {% for _ in empty_days_range %}
            <div class="day-cell bg-light"></div>
            {% endfor %}
        </div>
        {% endif %}

        <!-- Render Weeks -->
        {% for week in month_days %}
        <div class="week-row">
            {% for day in week %}
            <div class="day-cell {% if day.date.month != month %}bg-light{% endif %}">
                <div class="date">{{ day.date.day }}</div>
                {% if day.lessons %}
                <ul>
                    {% for lesson in day.lessons %}
                    <li>{{ lesson.start_time }} - {{ lesson.end_time }}: {{ lesson.notes }}</li>
                    {% endfor %}
                </ul>
                {% else %}
                <p class="text-muted">No lessons scheduled</p>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
